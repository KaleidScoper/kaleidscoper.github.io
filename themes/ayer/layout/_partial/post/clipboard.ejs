<script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  
  function initCopyCode(){
    var copyHtml = '';
    copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
    copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
    copyHtml += '</button>';
    
    // Add copy button to all code blocks
    $(".highlight").each(function() {
      var $highlight = $(this);
      if (!$highlight.find('.btn-copy').length) {
        $highlight.append(copyHtml);
      }
    });
    
    var clipboard = new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        var $highlight = $(trigger).closest('.highlight');
        var $code = $highlight.find('pre code');
        return $code[0] || $highlight.find('pre')[0];
      }
    });
    
    clipboard.on('success', function(e) {
      let $btn = $(e.trigger);
      $btn.addClass('copied');
      let $icon = $($btn.find('i'));
      $icon.removeClass('ri-file-copy-2-line');
      $icon.addClass('ri-checkbox-circle-line');
      let $span = $($btn.find('span'));
      $span[0].innerText = 'COPIED';
      
      wait(function () {
        $icon.removeClass('ri-checkbox-circle-line');
        $icon.addClass('ri-file-copy-2-line');
        $span[0].innerText = 'COPY';
      }, 2000);
    });
    
    clipboard.on('error', function(e) {
      e.clearSelection();
      let $btn = $(e.trigger);
      $btn.addClass('copy-failed');
      let $icon = $($btn.find('i'));
      $icon.removeClass('ri-file-copy-2-line');
      $icon.addClass('ri-time-line');
      let $span = $($btn.find('span'));
      $span[0].innerText = 'COPY FAILED';
      
      wait(function () {
        $icon.removeClass('ri-time-line');
        $icon.addClass('ri-file-copy-2-line');
        $span[0].innerText = 'COPY';
      }, 2000);
    });
  }
  
  // Initialize copy functionality
  $(document).ready(function() {
    setTimeout(initCopyCode, 100);
  });
</script>
